<div class="drawer">
  <input type="checkbox" id="navbar-drawer" class="drawer-toggle" />

  <div class="drawer-content">
    <div class="flex flex-row">
      <div class="flex-none hidden md:block">
        <newbee-authenticated-sidebar
          [organizations]="organizations"
          [selectedOrganization]="selectedOrganization"
          (selectedOrganizationChange)="selectOrganization($event)"
          (navigateToLink)="navigateToLink.emit($event)"
        ></newbee-authenticated-sidebar>
      </div>

      <div class="w-full">
        <div class="navbar w-full">
          <div class="navbar-start">
            <label
              for="navbar-drawer"
              class="btn btn-ghost drawer-button md:hidden"
            >
              <!-- bars-3 svg -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"
                />
              </svg>
            </label>

            <div
              *ngIf="selectedOrganization && isAdmin"
              class="dropdown hidden md:block"
            >
              <label
                tabindex="0"
                class="btn btn-ghost flex flex-row flex-nowrap gap-x-1"
              >
                <span class="truncate">{{ selectedOrganization!.name }}</span>
                <!-- chevron-down svg -->
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="w-4 h-4"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                  />
                </svg>
              </label>

              <ul
                tabindex="0"
                class="dropdown-content menu flex flex-col flex-nowrap mt-2 bg-base-200 rounded-box w-44"
              >
                <li>
                  <a
                    (click)="
                      emitNavigateToLink(
                        selectedOrganization.slug,
                        urlEndpoint.Edit
                      )
                    "
                    class="flex"
                    >Edit org settings</a
                  >
                </li>
                <li>
                  <a
                    (click)="
                      emitNavigateToLink(
                        selectedOrganization.slug,
                        urlEndpoint.Invite
                      )
                    "
                    class="flex"
                    >Invite members</a
                  >
                </li>
              </ul>
            </div>

            <p
              *ngIf="selectedOrganization && !isAdmin"
              class="uppercase font-semibold text-sm ml-4 hidden md:block"
            >
              {{ selectedOrganization.name }}
            </p>

            <p
              *ngIf="selectedOrganization"
              class="uppercase font-semibold text-sm ml-2 md:hidden"
            >
              {{ selectedOrganization.name }}
            </p>
          </div>

          <div class="navbar-end hidden md:flex">
            <div *ngIf="selectedOrganization" class="dropdown dropdown-end">
              <newbee-tooltip text="Create" placement="bottom">
                <label tabindex="0" class="btn btn-ghost">
                  <!-- document-plus svg -->
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-6 h-6"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"
                    />
                  </svg>
                </label>
              </newbee-tooltip>

              <ul
                tabindex="0"
                class="dropdown-content menu flex flex-col flex-nowrap mt-2 bg-base-200 rounded-box w-44"
              >
                <li>
                  <a
                    (click)="
                      emitNavigateToLink(
                        selectedOrganization!.slug,
                        urlEndpoint.Doc,
                        urlEndpoint.New
                      )
                    "
                    class="flex"
                    >Create doc</a
                  >
                </li>
                <li>
                  <a
                    (click)="
                      emitNavigateToLink(
                        selectedOrganization!.slug,
                        urlEndpoint.Qna,
                        urlEndpoint.New
                      )
                    "
                    class="flex"
                    >Create qna</a
                  >
                </li>
                <li *ngIf="isAdmin">
                  <a
                    (click)="
                      emitNavigateToLink(
                        selectedOrganization!.slug,
                        urlEndpoint.Team,
                        urlEndpoint.New
                      )
                    "
                    class="flex"
                    >Create team</a
                  >
                </li>
              </ul>
            </div>

            <div class="dropdown dropdown-end">
              <newbee-tooltip text="Account" placement="bottom">
                <label tabindex="0" class="btn btn-ghost">
                  {{ user.displayName ?? user.name }}
                </label>
              </newbee-tooltip>

              <ul
                tabindex="0"
                class="dropdown-content menu flex flex-col flex-nowrap mt-2 bg-base-200 rounded-box w-44"
              >
                <li>
                  <a (click)="emitNavigateToLink(urlEndpoint.User)" class="flex"
                    >Manage your account</a
                  >
                </li>
                <li><a (click)="emitLogout()" class="flex">Log out</a></li>
              </ul>
            </div>
          </div>
        </div>

        <ng-content></ng-content>
      </div>
    </div>
  </div>

  <div class="drawer-side">
    <label for="navbar-drawer" class="drawer-overlay"></label>
    <div class="flex flex-row w-3/4 sm:w-1/2">
      <div class="flex-none">
        <newbee-authenticated-sidebar
          [organizations]="organizations"
          [selectedOrganization]="selectedOrganization"
          (selectedOrganizationChange)="selectOrganization($event)"
          (navigateToLink)="navigateToLink.emit($event)"
        ></newbee-authenticated-sidebar>
      </div>
      <div
        class="flex flex-col flex-nowrap p-4 h-screen bg-base-200 w-full overflow-y-auto"
      >
        <div
          *ngIf="selectedOrganization && isAdmin"
          class="collapse collapse-arrow"
        >
          <input type="checkbox" id="org-collapse" />
          <label for="org-collapse" class="collapse-title">{{
            selectedOrganization.name
          }}</label>
          <div class="collapse-content flex flex-col gap-y-2 flex-nowrap">
            <a
              (click)="emitNavigateToLink(selectedOrganization.slug)"
              class="link link-hover"
              >Edit org settings</a
            >
            <a
              (click)="
                emitNavigateToLink(
                  selectedOrganization.slug,
                  urlEndpoint.Invite
                )
              "
              class="link link-hover"
              >Invite members</a
            >
          </div>
        </div>

        <div *ngIf="selectedOrganization" class="collapse collapse-arrow">
          <input type="checkbox" id="create-collapse" />
          <label for="create-collapse" class="collapse-title">Create</label>
          <div class="collapse-content flex flex-col flex-nowrap gap-y-2">
            <a
              (click)="
                emitNavigateToLink(
                  selectedOrganization!.slug,
                  urlEndpoint.Doc,
                  urlEndpoint.New
                )
              "
              class="link link-hover"
              >Create doc</a
            >
            <a
              (click)="
                emitNavigateToLink(
                  selectedOrganization!.slug,
                  urlEndpoint.Qna,
                  urlEndpoint.New
                )
              "
              class="link link-hover"
              >Create question</a
            >
            <a
              *ngIf="isAdmin"
              (click)="
                emitNavigateToLink(
                  selectedOrganization!.slug,
                  urlEndpoint.Team,
                  urlEndpoint.New
                )
              "
              class="link link-hover"
              >Create team</a
            >
          </div>
        </div>

        <div class="collapse collapse-arrow">
          <input type="checkbox" id="account-collapse" />
          <label for="account-collapse" class="collapse-title">Account</label>
          <div class="collapse-content flex flex-col flex-nowrap gap-y-2">
            <a
              (click)="emitNavigateToLink(urlEndpoint.User)"
              class="link link-hover"
              >Manage your account</a
            >
            <a (click)="emitLogout()" class="link link-hover">Log out</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
